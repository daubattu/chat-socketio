(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),o=p(a),s=p(n(127)),i=n(113),u=p(n(1146)),l=p(n(1148)),c=n(195),f=n(540),d=n(89);function p(e){return e&&e.__esModule?e:{default:e}}function m(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var s=t[a](o),i=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}("next")})}}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var g=function(e){function t(){var e,n,r,a,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,l=Array(u),c=0;c<u;c++)l[c]=arguments[c];return n=r=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),r.state={newGroup:{},openModal:{makeNewGroup:!1},isLoading:{makeNewGroup:!1},friends:[],membersSelected:[]},r.pushNotifycation=function(e,t){d.notification[e]({message:t})},r.isMe=function(e){return r.props.currentUser._id===e},r.actions={isChecked:function(e){var t=r.state.newGroup;if(!t.members)return-1;for(var n=0;n<t.members.length;n++){if(t.members[n]._id===e)return n}return-1},handleChangeStatusModal:function(e){var t=r.state.openModal;t[e]=!t[e],r.setState({openModal:t})},handleMakeNewGroup:(o=m(regeneratorRuntime.mark(function e(){var t,n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.state,n=t.newGroup,a=t.isLoading,o=t.openModal,a.makeNewGroup=!0,r.setState({isLoading:a}),e.next=5,s.default.post("/api/v1/groups",n).then(function(e){o.makeNewGroup=!1;var t=e.data.newGroup;t.lastMessage={user:r.props.currentUser,createdTime:Date.now(),type:"text",content:"Đã tạo nhóm"},r.pushNotifycation("success","Thêm nhóm "+n.name+" thành công"),r.props.handleAddNewGroup(t)},function(e){var t="Thêm nhóm "+n.name+" không thành công";e.response.data.message&&(t=e.response.data.message),r.pushNotifycation("error",t)});case 5:a.makeNewGroup=!1,r.setState({isLoading:a,openModal:o});case 7:case"end":return e.stop()}},e,i)})),function(){return o.apply(this,arguments)}),getFriends:(a=m(regeneratorRuntime.mark(function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.message.loading("",0),e.next=3,s.default.get("/api/v1/me/friends").then(function(e){var t=e.data.friends;r.actions.handleChangeStatusModal("makeNewGroup"),r.setState({friends:t})});case 3:d.message.destroy();case 4:case"end":return e.stop()}},e,i)})),function(){return a.apply(this,arguments)}),handleChangeNewGroup:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=r.state.newGroup;if("members"===e)if(a.members){var o=r.actions.isChecked(t);-1!==o?a.members.splice(o,1):a.members[a.members.length]=n}else a.members=[n];else a[e]=t;r.setState({newGroup:a})}},h(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"componentDidMount",value:function(){var e=m(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.default.get("/api/v1/groups").then(function(e){var n=e.data.groups||[];t.props.initGroups(n),t.props.setCurrentGroup(n[0])},function(){t.setState({groups:[]})});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.groups,n=this.state,r=n.openModal,a=n.isLoading,s=n.friends,i=n.newGroup;return o.default.createElement("nav",{className:"col-md-3 bg-light sidebar"},o.default.createElement("div",{className:"sidebar-sticky"},o.default.createElement("div",null,o.default.createElement("div",{className:"pt-3 px-4"},o.default.createElement("h2",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},"Groups ",o.default.createElement("i",{id:"icon-open-modal-make-new-group",onClick:function(){return e.actions.getFriends()},style:{cursor:"pointer"},className:"fa fa-plus","aria-hidden":"true"}))),o.default.createElement("div",{className:"list-groups"},o.default.createElement(u.default,{currentUser:this.props.currentUser,isMe:this.isMe,groups:t,setCurrentGroup:this.props.setCurrentGroup})),o.default.createElement(l.default,{newGroup:i,actions:this.actions,visible:r.makeNewGroup,isLoading:a.makeNewGroup,friends:s}))))}}]),t}();t.default=(0,i.connect)(function(e){return{groups:e.groups,currentUser:e.auth.user}},{setCurrentGroup:c.setCurrentGroup,initGroups:f.initGroups,handleAddNewGroup:f.handleAddNewGroup})(g)},1146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=s(r),o=s(n(1147));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.groups,n=e.setCurrentGroup,s=e.isMe,i=e.currentUser;return a.default.createElement(r.Fragment,null,t.map(function(e,t){return a.default.createElement(o.default,{key:e._id||t,currentUser:i,isMe:s,group:e,setCurrentGroup:n})}))}},1147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),o=(r=a)&&r.__esModule?r:{default:r};t.default=function(e){var t,n,r=e.group,s=e.setCurrentGroup,i=e.isMe,u=e.currentUser;return o.default.createElement("div",{className:0!==r.numberOfMessagesUnReaded?"group has-new-message px-4":"group px-4"},function(e,t){var n=[];return t=(t=t.filter(function(r){if(r._id!==e._id&&-1===n.indexOf(r._id))return n.push(r._id),t})).slice(0,4),o.default.createElement("div",{className:"group-avatar group-avatar-"+(t.length<4?t.length+1:"n")},t.map(function(e,t){return o.default.createElement("img",{id:e._id,key:e._id||t,src:e.avatar})}))}(u,r.members),o.default.createElement("div",{className:"group-detail"},o.default.createElement("b",{className:"group-name",onClick:function(){return s(r)}},r.name," ",0!==r.numberOfMessagesUnReaded&&o.default.createElement("span",{style:{color:"red"}},"(",r.numberOfMessagesUnReaded,")")),r.lastMessage&&o.default.createElement("div",null,o.default.createElement("div",{className:"group-last-message"},o.default.createElement("small",{style:{maxWidth:"80%",overflow:"hidden"}},i(r.lastMessage.user._id)&&"You: ","text"===(n=r.lastMessage).type?n.content?n.content.slice(0,30):"":"image"===n.type?o.default.createElement(a.Fragment,null,"Đã gửi ",n.files.length," bức ảnh ",o.default.createElement("i",{className:"fa fa-picture-o"})):"video"===n.type?o.default.createElement(a.Fragment,null,"Đã gửi ",n.files.length," video ",o.default.createElement("i",{className:"fa fa-video-camera"})):"file"===n.type?o.default.createElement(a.Fragment,null,"Đã gửi ",n.files.length," file đính kèm ",o.default.createElement("b",null,o.default.createElement("i",{className:"fa fa-paperclip"}))):"Đã gửi 1 thứ gì đó hay ho",i(r.lastMessage.user._id)&&function(e){var t="";if(e.memberReaded){var n=!0,r=!1,a=void 0;try{for(var s,i=e.memberReaded[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var u=s.value;u._id!==e.user._id&&(t+=""===t?u.name:", "+u.name)}}catch(e){r=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw a}}return""!==t?o.default.createElement("small",null,o.default.createElement("i",{style:{color:"green",marginLeft:"5px"},className:"fa fa-check-circle-o","aria-hidden":"true"})):null}return null}(r.lastMessage)),!i(r.lastMessage.user._id)&&o.default.createElement("img",{src:r.lastMessage.user.avatar,style:{height:"20px"}})),o.default.createElement("small",{style:{textAlign:"right",width:"100%",display:"inline-block"}},(t=r.lastMessage.createdTime,new Date(t).toLocaleTimeString()+" - "+new Date(t).toLocaleDateString())))))}},1148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=i(r),o=n(89),s=i(n(1149));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.friends,n=e.visible,i=e.isLoading,u=e.actions,l=e.newGroup;return a.default.createElement(r.Fragment,null,a.default.createElement(o.Modal,{width:"60%",title:"Tạo nhóm",visible:n,onCancel:function(){return u.handleChangeStatusModal("makeNewGroup")},footer:[a.default.createElement(o.Button,{key:"back",onClick:function(){return u.handleChangeStatusModal("makeNewGroup")}},"Hủy"),a.default.createElement(o.Button,{key:"submit",type:"primary",disabled:!(l.name&&l.members&&l.members.length>1),loading:i,onClick:u.handleMakeNewGroup},"Tạo")]},a.default.createElement("div",{className:"modal-make-new-group"},a.default.createElement("div",{className:"row modal-make-new-group-head"},a.default.createElement("div",{className:"col-lg-12"},a.default.createElement("input",{value:l.name||"",onChange:function(e){return u.handleChangeNewGroup("name",e.target.value)},className:"form-control",id:"name",placeholder:"Tên nhóm"}))),a.default.createElement("div",{className:"row modal-make-new-group-main"},a.default.createElement("div",{className:"col-lg-7 modal-make-new-group-main-friends"},a.default.createElement("div",{style:{height:"45px"}},a.default.createElement("input",{className:"form-control",id:"search-friend",placeholder:"Tìm kiếm"})),a.default.createElement("div",{className:"modal-make-new-group-main-friends-data"},a.default.createElement(s.default,{newGroup:l,actions:u,friends:t}))),a.default.createElement("div",{className:"col-lg-5 modal-make-new-group-main-members"},a.default.createElement("div",{style:{height:"45px"}},a.default.createElement("b",null,"Đã chọn ",a.default.createElement("b",null,"(",l.members?l.members.length:0,")"))),a.default.createElement("div",{className:"modal-make-new-group-main-friends-data-selected"},l.members&&a.default.createElement(s.default,{newGroup:l,actions:u,remove:!0,friends:l.members})))))))}},1149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(1150));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.friends,n=e.actions,o=e.remove;return r.default.createElement("div",{style:{marginRight:"10px"}},t.map(function(e,t){return r.default.createElement(a.default,{actions:n,key:e._id||t,remove:o,friend:e})}))}},1150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),o=(r=a)&&r.__esModule?r:{default:r},s=n(89);t.default=function(e){var t=e.friend,n=e.actions,r=e.remove;return o.default.createElement("div",{className:"item-friend-in-modal-make-new-group",style:{marginBottom:"5px",display:"flex",justifyContent:"space-between",alignItems:"center"}},o.default.createElement("div",{onClick:function(){return n.handleChangeNewGroup("members",t._id,t)},style:{flexGrow:"1"}},o.default.createElement("img",{src:t.avatar,style:{height:"40px",marginRight:"5px"}}),o.default.createElement("b",null,t.name||t.username)),o.default.createElement("div",null,r?o.default.createElement(s.Icon,{onClick:function(){return n.handleChangeNewGroup("members",t._id,t)},type:"delete"}):o.default.createElement(s.Checkbox,{checked:-1!==n.isChecked(t._id),onChange:function(){return n.handleChangeNewGroup("members",t._id,t)}})))}},1151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),s=d(o),i=d(n(1152)),u=d(n(127)),l=n(113),c=n(541),f=n(195);function d(e){return e&&e.__esModule?e:{default:e}}function p(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var s=t[a](o),i=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}("next")})}}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=function(e){function t(){var e,n,a,o,s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,l=Array(i),c=0;c<i;c++)l[c]=arguments[c];return n=a=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.state={params:{}},a.getFriends=(o=p(regeneratorRuntime.mark(function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r({},a.state.params,n),t=[].friends,e.next=4,u.default.get("/api/v1/me/friends",{params:n}).then(function(e){t=e.data.friends||[]},function(){});case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}},e,s)})),function(){return o.apply(this,arguments)}),m(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"componentDidMount",value:function(){var e=p(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getFriends();case 2:t=e.sent,this.props.initFriends(t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.friends,n=e.setCurrentGroup;return s.default.createElement(o.Fragment,null,s.default.createElement(i.default,{setCurrentGroup:n,friends:t.filter?t.filter:t.all}))}}]),t}();t.default=(0,l.connect)(function(e){return{friends:e.friends}},{initFriends:c.initFriends,setCurrentGroup:f.setCurrentGroup})(h)},1152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(1153));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.friends,n=e.setCurrentGroup;return r.default.createElement("div",{className:"col-md-2"},r.default.createElement("div",{className:"pt-3"},r.default.createElement("h2",null,"Online")),r.default.createElement(a.default,{setCurrentGroup:n,friends:t}))}},1153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(1154));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.friends,n=e.setCurrentGroup;return t?r.default.createElement("div",{className:"list-friends"},t.map(function(e,t){return r.default.createElement(a.default,{setCurrentGroup:n,key:e._id||t,friend:e})})):null}},1154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=o(n(1));o(n(7));function o(e){return e&&e.__esModule?e:{default:e}}var s={avatar:{width:"30px",height:"30px",borderRadius:"50%",marginRight:"5px"},status:{width:"5px",height:"5px",borderRadius:"50%"}};t.default=function(e){var t,n=e.friend,o=e.setCurrentGroup;return a.default.createElement("div",{onClick:function(){return o(n.group)},className:"item-list-friends",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},a.default.createElement("div",{className:"item-list-friends-info"},a.default.createElement("img",{src:n.avatar,style:s.avatar}),a.default.createElement("b",null,n.name)),a.default.createElement("div",{className:"item-list-friends-status"},n.online?a.default.createElement("div",{style:r({},s.status,{background:"green"})}):n.latestTimeConnection?(t=n.latestTimeConnection,a.default.createElement("small",null,new Date(t).toLocaleTimeString()," - ",new Date(t).toLocaleDateString())):a.default.createElement("div",{style:r({},s.status,{background:"red"})})))}},1155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),s=y(o),i=n(113),u=y(n(1156)),l=y(n(1181)),c=y(n(1184)),f=y(n(127)),d=n(152),p=n(195),m=n(540),h=n(89),g=n(541);function y(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(a,o){try{var s=t[a](o),i=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}("next")})}}function b(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var E=void 0,w=h.Modal.confirm,j=function(e){function t(){var e,n,a,o,s,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,l=Array(u),c=0;c<u;c++)l[c]=arguments[c];return n=a=_(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.state={messages:[],message:{type:"text",content:null,files:[]},openModal:{listMembers:!1},loading:{addNewMember:!1,deleteMember:!1},newMemberIds:[],socket:null,isTyping:!1,openExtendTypeMessage:!1,deleteMemberId:null},a.actions={confirmDeleteMember:function(e){var t=a,n=a.props.group;w({title:"Bạn có thực sự muốn xóa người dùng "+(e.name||e.username)+" khỏi nhóm chat "+n.name+"?",width:"30%",onOk:function(){return new Promise(function(a,o){f.default.delete("/api/v1/groups/"+n._id+"/members",{params:{deleteMemberId:e._id}}).then(function(){t.props.pushNotifycation("success","Xóa người dùng "+(e.name||e.username)+" khỏi nhóm chat "+n.name+" thành công");for(var o=n.members,s=0;s<o.length;s++)if(o[s]._id===e._id){t.props.deleteMemberOfGroup(o[s]._id);break}t.actions.handleChangeStatusModal("listMembers"),t.props.handleUpdateGroup(r({},n,{members:[].concat(b(n.members)).filter(function(t){return t._id!==e._id})})),a()},function(r){var a="Xóa người dùng "+(e.name||e.username)+" khỏi nhóm chat "+n.name+" không thành công";r.response.data.message&&(a=r.response.data.message),t.props.pushNotifycation("error",a),o()})})},onCancel:function(){}})},handleChangeNewMemberIds:function(e){return a.setState({newMemberIds:e})},handleChangeStatusModal:function(e){var t=a.state,n=t.openModal,r=t.newMemberIds;n[e]=!n[e],"lisMembers"===e&&(r=""),a.setState({openModal:n,newMemberIds:r})},handleChangeStateOpenExtendTypeMessage:function(){a.setState({openExtendTypeMessage:!a.state.openExtendTypeMessage})},handleAddNewMembers:(s=v(regeneratorRuntime.mark(function e(){var t,n,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.group,n=a.state,o=n.loading,s=n.newMemberIds,o.addNewMember=!0,a.setState({loading:o}),e.next=6,f.default.post("/api/v1/groups/"+t._id+"/members",{newMemberIds:s.split(",")}).then(function(e){a.props.pushNotifycation("success","Thêm thành viên vào nhóm "+t.name+" thành công"),a.props.addMembersGroup(e.data.newMembers),a.actions.handleChangeStatusModal("listMembers"),a.props.handleUpdateGroup(r({},t,{members:[].concat(b(t.members),b(e.data.newMembers))}))},function(e){var n="Thêm thành viên vào nhóm "+t.name+" không thành công";e.response.data.message&&(n=e.response.data.message),a.props.pushNotifycation("success",n)});case 6:o.addNewMember=!1,a.setState({loading:o});case 8:case"end":return e.stop()}},e,i)})),function(){return s.apply(this,arguments)}),handleSendMessage:(o=v(regeneratorRuntime.mark(function e(){var t,n,o,s,u,l,c,d,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(document.getElementById("message-content").blur(),t=r({},a.state.message),n=new FormData,o={headers:{"Content-Type":"multipart/form-data"}},"text"===t.type||!t.files){e.next=24;break}for(s=!0,u=!1,l=void 0,e.prev=8,c=t.files[Symbol.iterator]();!(s=(d=c.next()).done);s=!0)p=d.value,n.append("attachments",p.file);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),u=!0,l=e.t0;case 16:e.prev=16,e.prev=17,!s&&c.return&&c.return();case 19:if(e.prev=19,!u){e.next=22;break}throw l;case 22:return e.finish(19);case 23:return e.finish(16);case 24:t.content&&n.append("content",t.content),n.append("groupId",a.props.group._id),n.append("type",t.type),f.default.post("/api/v1/messages",n,o).then(function(){t={type:"text",content:null,files:null},a.setState({message:t})},function(e){var t=a.state.messages,n=a.props.currentUser;t.push({type:"text",content:"Gửi thất bại",error:!0,createdTime:Date.now(),user:n}),a.setState({messages:t}),a.scrollToBottomOfWrapperMessages(),console.log(e)});case 28:case"end":return e.stop()}},e,i,[[8,12,16,24],[17,,19,23]])})),function(){return o.apply(this,arguments)}),handleOnTyping:function(){E.emit("typing",{groupId:a.props.group._id})},handleUnTyping:function(){E.emit("unTyping",{groupId:a.props.group._id})},handleChangeMessage:function(e,t){var n=a.state.message;n[e]=t,a.setState({message:n})},handleDeleteFilesWithIndex:function(e){var t=a.state.message,n=[].concat(b(t.files));n.splice(e,1),t.files=n,0===t.files.length&&(t.files=[],t.type="text"),a.setState({message:t})},handleChangeMessageWithFile:function(e,t){var n=a.state.message;if("image"!==e&&t[0].size>26214400)a.props.pushNotifycation("error","Kích thước file upload không được vượt quá 25 MB");else{console.log(t.length),n.type=e,n.files=[];for(var r=function(e){var r=new FileReader;n.files[e]||(n.files[e]={}),console.log(a.state.message),n.files[e].file=t[e],n.files[e].name=t[e].name+" - "+function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}(t[e].size),n.files[e].isLoading=!0,a.setState({message:n}),a.scrollToBottomOfWrapperMessages(),r.onload=function(t){n.files[e].src=t.target.result,n.files[e].isLoading=!1,a.setState({message:n}),a.scrollToBottomOfWrapperMessages()},r.readAsDataURL(t[e]),document.getElementById("message-content").focus()},o=0;o<t.length;o++)r(o)}}},a.isMe=function(e){return a.props.currentUser._id===e},a.isLatestMessage=function(e){return!(!a.state.messages||a.state.messages[a.state.messages.length-1]._id!==e)},_(a,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"scrollToBottomOfWrapperMessages",value:function(){var e=document.getElementById("wrapper-messages");e&&(e.scrollTop=e.scrollHeight)}},{key:"GetMessage",value:function(){var e=v(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({messages:null}),e.next=3,f.default.get("/api/v1/messages",{params:{group:t}}).then(function(e){var t=e.data.messages||[];n.setState({messages:t}),n.scrollToBottomOfWrapperMessages()},function(e){n.setState({messages:[]}),console.log(e.response.data)});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=this;(E=(0,u.default)("http://chatapp.stovietnam.com")).on("newConnection",function(e){console.log(e)}),E.on("readedLastMessage",function(t){if(e.state.messages){console.log("data readedLastMessage",t);var n=[].concat(b(e.state.messages)),r=n[n.length-1];if(r.user._id===e.props.currentUser._id&&r.user._id!==t.user._id){r.memberReaded||(r.memberReaded=[]),r.memberReaded.push(t.user),n[e.state.messages.length-1]=r,e.setState({messages:n}),console.log("lastMessage",r.user);var a=void 0;if(e.props.groups){var o=!0,s=!1,i=void 0;try{for(var u,l=e.props.groups[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;c._id===r.group&&(a=c)}}catch(e){s=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw i}}}a&&(a.lastMessage=r,e.props.handleUpdateGroup(a))}}}),E.on("yourFriendOnline",function(t){console.log("your friend have just connected",t),e.props.updateFriend(r({},t,{online:!0}))}),E.on("yourFriendOffline",function(t){console.log("your friend have just disconnected",t),e.props.updateFriend(r({},t,{online:!1}))}),E.emit("authenticate",{tokenJWT:localStorage.tokenJWT}),E.on("unauthorized",function(t){console.log("unauthorized: ",t.message),t?(e.props.pushNotifycation("error",t.message),E.disconnect(),"error"===t.level&&(e.props.handleLogOut(),e.props.history.replace("/auth/login"))):e.props.pushNotifycation("error","Không có phản hồi từ server")}),E.on("typing",function(t){console.log(t),document.getElementById("message-content").placeholder="",e.setState({isTyping:!0})}),E.on("unTyping",function(){e.setState({isTyping:!1})}),E.on("receiveNewMessage",function(t){var n=r({},t.group,{lastMessage:r({},t,{user:t.user}),numberOfMessagesUnReaded:0});if(e.props.group._id===t.group._id){console.log("Có tin nhắn ở group này",t.group);var a=e.state.messages;a.push(t),e.setState({messages:a}),e.scrollToBottomOfWrapperMessages(),e.props.handleUpdateGroup(n)}else{if(e.props.currentUser._id!==t.user._id){var o=void 0;if(e.props.groups){var s=!0,i=!1,u=void 0;try{for(var l,c=e.props.groups[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var f=l.value;f._id===n._id&&(o=f)}}catch(e){i=!0,u=e}finally{try{!s&&c.return&&c.return()}finally{if(i)throw u}}}o&&(n.numberOfMessagesUnReaded=o.numberOfMessagesUnReaded+1)}e.props.handleUpdateGroup(n),console.log("Có tin nhắn ở group khác",t.group.name)}})}},{key:"componentWillReceiveProps",value:function(e){if(e.group._id&&e.group._id!==this.props.group._id){this.GetMessage(e.group._id),E.emit("joinRoom",{groupId:e.group._id});var t=void 0;if(this.props.groups){var n=!0,r=!1,a=void 0;try{for(var o,s=this.props.groups[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var i=o.value;i._id===e.group._id&&(t=i)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}}t&&0!==t.numberOfMessagesUnReaded&&(t.numberOfMessagesUnReaded=0,this.props.handleUpdateGroup(t,!1)),this.props.group._id&&(this.setState({isTyping:!1}),E.emit("leaveRoom",{groupId:this.props.group._id}))}}},{key:"render",value:function(){var e=this.props.group,t=this.state,n=t.openModal,r=t.loading,a=t.newMemberIds,o=t.messages,i=t.message,u=t.isTyping,f=t.openExtendTypeMessage;return s.default.createElement("main",{role:"main",className:"col-md-7 ml-sm-auto pt-3 px-4 border-right",style:{height:"calc(100vh - 48px)"}},s.default.createElement(l.default,{isLatestMessage:this.isLatestMessage,message:i,openExtendTypeMessage:f,isMe:this.isMe,isTyping:u,group:e,actions:this.actions,messages:o}),s.default.createElement(c.default,{group:e,actions:this.actions,isLoading:r.addNewMember,visible:n.listMembers,newMemberIds:a}))}}]),t}();t.default=(0,i.connect)(function(e){return{groups:e.groups,group:e.group,currentUser:e.auth.user,auth:e.auth}},{handleLogOut:d.handleLogOut,setCurrentGroup:p.setCurrentGroup,deleteMemberOfGroup:p.deleteMemberOfGroup,addMembersGroup:p.addMembersGroup,handleUpdateGroup:m.handleUpdateGroup,updateFriend:g.updateFriend})(j)},1178:function(e,t){},1181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=s(r),o=s(n(1182));function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.default=function(e){var t,n=e.group,s=e.actions,u=e.messages,l=e.message,c=e.isTyping,f=e.isMe,d=e.openExtendTypeMessage,p=e.isLatestMessage,m=function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]};return a.default.createElement(r.Fragment,null,n._id&&a.default.createElement("div",{style:{position:"relative",width:"100%"}},a.default.createElement("div",{className:"info-group",style:{width:"100%",background:"#eee",position:"absolute",padding:"5px 10px",borderRadius:"3px"}},a.default.createElement("b",null,n.name),a.default.createElement("small",{onClick:function(){return s.handleChangeStatusModal("listMembers")},style:{cursor:"pointer"}}," ",n.members.length," thành viên"))),a.default.createElement("div",{style:{marginTop:"31px",display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}},a.default.createElement("div",{id:"wrapper-messages",style:{flexGrow:"1",overflow:"auto",height:"100vh"}},a.default.createElement(o.default,{numberOfMember:n.members?n.members.length:0,isLatestMessage:p,isMe:f,messages:u})),a.default.createElement("div",null,a.default.createElement("div",{className:"input-message",style:{marginBottom:"40px",position:"relative"}},a.default.createElement("div",{style:{position:"relative"}},c&&!l.content?a.default.createElement("img",{className:"typing",src:"/images/typing.gif"}):null,a.default.createElement("textarea",{onKeyPress:function(e){"Enter"===e.key&&s.handleSendMessage()},value:l.content||"",id:"message-content",onFocus:s.handleOnTyping,onBlur:s.handleUnTyping,onChange:function(e){return s.handleChangeMessage("content",e.target.value)},className:"form-control",placeholder:"Nhập tin nhắn"}),a.default.createElement("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:"15px",display:"flex",alignItems:"center"}},a.default.createElement("div",{className:d?"extend-type-message is-extend":"extend-type-message"},d&&a.default.createElement(r.Fragment,null,a.default.createElement("label",{htmlFor:"image",onClick:function(){return s.handleChangeMessage("type","image")}},a.default.createElement("i",{className:"image"===l.type?"fa fa-picture-o selected":"fa fa-picture-o",style:{cursor:"pointer"},"aria-hidden":"true"})),a.default.createElement("input",{onBlur:function(){return console.log("Un Change")},accept:"image/*",multiple:!0,onChange:function(e){return s.handleChangeMessageWithFile("image",e.target.files)},id:"image",type:"file"}),a.default.createElement("label",{htmlFor:"video",onClick:function(){return s.handleChangeMessage("type","video")}},a.default.createElement("i",{className:"video"===l.type?"fa fa-video-camera selected":"fa fa-video-camera",style:{margin:"0 5px",cursor:"pointer"},"aria-hidden":"true"})),a.default.createElement("input",{accept:"video/*",onChange:function(e){return s.handleChangeMessageWithFile("video",e.target.files)},id:"video",type:"file"}),a.default.createElement("label",{htmlFor:"file",onClick:function(){return s.handleChangeMessage("type","file")}},a.default.createElement("i",{className:"file"===l.type?"fa fa-paperclip selected":"fa fa-paperclip",style:{cursor:"pointer",fontWeight:"bold"},"aria-hidden":"true"})),a.default.createElement("input",{onChange:function(e){return s.handleChangeMessageWithFile("file",e.target.files)},id:"file",type:"file"})),a.default.createElement("i",{onClick:s.handleChangeStateOpenExtendTypeMessage,style:{cursor:"pointer"},className:"fa fa-chevron-right","aria-hidden":"true"})),a.default.createElement("i",(i(t={onClick:function(){l.content&&s.handleChangeStateOpenExtendTypeMessage},style:{cursor:"pointer",marginLeft:"10px"}},"onClick",s.handleSendMessage),i(t,"className",function(e){return"text"===e.type?e.content?"fa fa-paper-plane-o valid":"fa fa-paper-plane-o":e.files&&0!==e.files.length?"fa fa-paper-plane-o valid":"fa fa-paper-plane-o"}(l)),i(t,"aria-hidden","true"),t)))),"text"!==l.type&&l.files&&0!==l.files.length?a.default.createElement("div",{className:"preview-files-attachment "+l.type},a.default.createElement(r.Fragment,null,l.files.map(function(e,t){return e.isLoading?a.default.createElement("img",{key:t,src:"/images/loading.gif",style:{height:"20px",marginRight:"5px"}}):function(e,t){return"image"===l.type?a.default.createElement("div",{key:t,className:"item-preview-image",onClick:function(){return s.handleDeleteFilesWithIndex(t)}},a.default.createElement("i",{className:"fa fa-trash-o","aria-hidden":"true"}),a.default.createElement("img",{src:e.src,style:{height:"50px"}})):"video"===l.type?a.default.createElement("div",{key:t,className:"item-preview-video"},a.default.createElement("i",{className:"fa fa-file-video-o","aria-hidden":"true"})," ",e.file.name," - ",m(e.file.size),a.default.createElement("i",{style:{marginLeft:"5px",cursor:"pointer"},onClick:function(){return s.handleDeleteFilesWithIndex(t)},className:"fa fa-trash-o","aria-hidden":"true"})):"file"===l.type?a.default.createElement("div",{key:t,className:"item-preview-file"},a.default.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"})," ",e.file.name," - ",m(e.file.size),a.default.createElement("i",{style:{marginLeft:"5px",cursor:"pointer"},onClick:function(){return s.handleDeleteFilesWithIndex(t)},className:"fa fa-trash-o","aria-hidden":"true"})):null}(e,t)}))):null))))}},1182:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=s(r),o=s(n(1183));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.messages,n=e.isMe,s=e.isLatestMessage,i=e.numberOfMember;return a.default.createElement("div",{className:"list-messages",style:{marginTop:"10px"}},t&&a.default.createElement(r.Fragment,null,t.map(function(e,t){return a.default.createElement(o.default,{key:e._id||t,message:e,numberOfMember:i,isLatestMessage:s,isMe:n})})))}},1183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),o=(r=a)&&r.__esModule?r:{default:r},s=n(89);function i(e){return new Date(e).toLocaleTimeString()+" - "+new Date(e).toLocaleDateString()}t.default=function(e){var t,n,r=e.message,u=e.isMe,l=e.isLatestMessage,c=e.numberOfMember;return o.default.createElement("div",{className:u(r.user._id)?"item-message me":"item-message"},!u(r.user._id)&&o.default.createElement("img",{src:r.user.avatar,style:{height:"30px",marginRight:"5px"}}),o.default.createElement("div",null,r.content&&o.default.createElement(s.Tooltip,{placement:u(r.user._id)?"left":"right",title:i(r.createdTime)},o.default.createElement("span",{className:r.error?"item-message-content error":"item-message-content"},r.content)),r.files&&0!==r.files.length?o.default.createElement(s.Tooltip,{placement:u(r.user._id)?"left":"right",title:i(r.createdTime)},o.default.createElement("div",{className:"message-attachments"},(t=r.type,n=r.files,"image"===t?o.default.createElement(a.Fragment,null,n.map(function(e,t){return o.default.createElement("img",{key:t,src:e,className:"message-attachments-item image"})})):"video"===t?o.default.createElement(a.Fragment,null,n.map(function(e,t){return o.default.createElement("video",{key:t,src:e,className:"message-attachments-item video",style:{height:"150px",marginTop:"5px"},controls:!0})})):"file"===t?o.default.createElement(a.Fragment,null,n.map(function(e,t){return o.default.createElement("a",{download:!0,key:t,href:e},o.default.createElement("i",{className:"fa fa-download","aria-hidden":"true"}))})):void 0))):null,o.default.createElement("div",{className:"member-readed-message"},l(r._id)&&function(e,t,n,r){var a="";if(e.memberReaded){var s=!0,i=!1,u=void 0;try{for(var l,c=e.memberReaded[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var f=l.value;f._id===e.user._id||r(f._id)||(a+=""===a?f.name:", "+f.name)}}catch(e){i=!0,u=e}finally{try{!s&&c.return&&c.return()}finally{if(i)throw u}}return""===a?null:2===n?t?o.default.createElement("small",null,o.default.createElement("i",{style:{color:"green"},className:"fa fa-check-circle-o","aria-hidden":"true"})," Đã xem"):null:o.default.createElement("small",null,o.default.createElement("i",{style:{color:"green"},className:"fa fa-check-circle-o","aria-hidden":"true"})," ",a," đã xem")}return null}(r,u(r.user._id),c,u))))}},1184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),o=(r=a)&&r.__esModule?r:{default:r},s=n(89);t.default=function(e){var t=e.group,n=e.visible,r=e.actions,i=e.isLoading,u=e.newMemberIds;return o.default.createElement(s.Modal,{title:"Thành viên nhóm "+(t._id&&t.name),visible:n,onCancel:function(){return r.handleChangeStatusModal("listMembers")},footer:[o.default.createElement(s.Button,{key:"back",onClick:function(){return r.handleChangeStatusModal("listMembers")}},"Trở lại"),o.default.createElement(s.Button,{key:"submit",type:"primary",loading:i,onClick:r.handleAddNewMembers},"Thêm vào nhóm")]},t._id&&o.default.createElement(a.Fragment,null,t.members.map(function(e,t){return o.default.createElement("div",{className:"item-member-of-modal-members-group",onClick:function(){return r.confirmDeleteMember(e)},key:e._id||t,style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"5px"}},o.default.createElement("div",null,o.default.createElement("img",{src:e.avatar,style:{width:"30px",height:"30px",marginRight:"5px"}}),o.default.createElement("b",null,e.username)),o.default.createElement(s.Icon,{type:"delete"}))})),o.default.createElement("textarea",{onChange:function(e){return r.handleChangeNewMemberIds(e.target.value)},value:u||"",className:"form-control",style:{marginTop:"15px"}}),o.default.createElement("small",null,"Nhập _id người dùng cách nhau bởi dấu , để thêm vào nhóm hoặc tạo nhóm mới",o.default.createElement("br",null),"VD: 123,321"))}},1188:function(e,t){},1190:function(e,t){},1225:function(e,t){},1226:function(e,t){},1284:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),o=f(a),s=f(n(1285)),i=n(113),u=n(152),l=n(195),c=f(n(127));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=r=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.actions={handleLogout:function(){c.default.get("/api/v1/auth/logout"),r.props.handleLogOut(),r.props.setCurrentGroup({}),r.props.history.push("/auth/login")}},d(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props.auth;return o.default.createElement(s.default,{user:e?e.user:{},actions:this.actions})}}]),t}();t.default=(0,i.connect)(function(e){return{auth:e.auth}},{handleLogOut:u.handleLogOut,setCurrentGroup:l.setCurrentGroup})(p)},1285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),o=(r=a)&&r.__esModule?r:{default:r};t.default=function(e){var t=e.actions,n=e.user;return o.default.createElement("nav",{className:"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0"},o.default.createElement("a",{className:"navbar-brand col-sm-3 col-md-2 mr-0",href:"#"},"Mesage"),o.default.createElement("ul",{className:"navbar-nav ml-auto px-3",style:{display:"flex",flexDirection:"row"}},o.default.createElement("li",{className:"nav-item",style:{marginRight:"15px"}},o.default.createElement("span",{className:"nav-link"},o.default.createElement("img",{src:n.avatar,style:{height:"20px",marginRight:"5px"}})," ",n.username)),o.default.createElement("li",{className:"nav-item text-nowrap"},o.default.createElement("span",{style:{cursor:"pointer"},className:"nav-link",onClick:t.handleLogout},"Đăng xuất"))))}},1286:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),o=u(a),s=n(594),i=u(n(1287));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){return o.default.createElement(a.Fragment,null,o.default.createElement(s.Switch,null,i.default.map(function(e,t){return o.default.createElement(s.Route,{key:t,exact:e.exact,path:e.path,component:e.component})})))}}]),t}();t.default=l},1287:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1288)),a=o(n(1291));function o(e){return e&&e.__esModule?e:{default:e}}var s=[{path:"/auth/login",exact:!0,component:r.default},{path:"/auth/signup",component:a.default}];t.default=s},1288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),o=d(a),s=d(n(127)),i=d(n(1289)),u=n(89);n(534);var l=n(113),c=n(152),f=n(593);function d(e){return e&&e.__esModule?e:{default:e}}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var m=function(e){function t(){var e,n,r,a,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var l=arguments.length,c=Array(l),d=0;d<l;d++)c[d]=arguments[d];return n=r=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.state={auth:{email:null,password:null},loading:!1},r.pushNotifycation=function(e,t){u.notification[e]({message:t})},r.actions={handleChange:function(e){var t=e.target,n=t.id,a=t.value,o=r.state.auth;o[n]=a,r.setState({auth:o})},handleLogin:(a=regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.state.auth,r.setState({loading:!0}),e.next=4,s.default.post("/api/v1/auth/login",t).then(function(e){r.setState({loading:!1}),localStorage.tokenJWT=e.data.tokenJWT,(0,f.setAuthorizationHeader)(e.data.tokenJWT),r.props.setCurrentUser(e.data.tokenJWT),r.props.history.push("/")},function(e){var t="Đăng nhập không thành công";e.response.data.message&&(t=e.response.data.message),r.pushNotifycation("error",t),r.setState({loading:!1})}).catch(function(e){console.log(e),r.pushNotifycation("error","Đăng nhập không thành công"),r.setState({loading:!1})});case 4:case"end":return e.stop()}},e,i)}),o=function(){var e=a.apply(this,arguments);return new Promise(function(t,n){return function r(a,o){try{var s=e[a](o),i=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});t(i)}("next")})},function(){return o.apply(this,arguments)})},p(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.state,t=e.auth,n=e.loading;return o.default.createElement(i.default,{actions:this.actions,loading:n,auth:t})}}]),t}();t.default=(0,l.connect)(null,{setCurrentUser:c.setCurrentUser})(m)},1289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),o=(r=a)&&r.__esModule?r:{default:r};t.default=function(e){var t=e.actions,n=e.auth,r=e.loading;return o.default.createElement("div",{className:"login-page"},o.default.createElement("form",{className:"form-login"},o.default.createElement("img",{className:"mb-4",src:"https://getbootstrap.com/docs/4.0/assets/brand/bootstrap-solid.svg",alt:"",width:"72",height:"72"}),o.default.createElement("h1",{className:"text-center h3 mb-3 font-weight-normal"},"Đăng nhập"),o.default.createElement("input",{value:n.email||"",style:{marginBottom:"5px"},id:"email",onChange:t.handleChange,type:"email",className:"form-control",placeholder:"Email",required:!0,autoFocus:!0}),o.default.createElement("input",{value:n.password||"",style:{marginBottom:"10px"},id:"password",onChange:t.handleChange,type:"password",className:"form-control",placeholder:"Mật khẩu",required:!0}),o.default.createElement("button",{disabled:r,onClick:t.handleLogin,className:"btn btn-lg btn-primary btn-block",type:"submit"},r&&o.default.createElement("i",{style:{marginRight:"5px"},className:"fa fa-circle-o-notch fa-spin","aria-hidden":"true"}),"Đăng nhập"),o.default.createElement("p",{className:"text-center mt-5 mb-3 text-muted"},"© 2019-2020")))}},1290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e?o.default.defaults.headers.common.Authorization="Bearer "+e:delete o.default.defaults.headers.common.Authorization};var r,a=n(127),o=(r=a)&&r.__esModule?r:{default:r}},1291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),s=(r=o)&&r.__esModule?r:{default:r};var i=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.Component),a(t,[{key:"render",value:function(){return s.default.createElement("h1",null,"Signup")}}]),t}();t.default=i},1292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.default=function(e){var t=function(t){function n(){var e,t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var a=arguments.length,o=Array(a),s=0;s<a;s++)o[s]=arguments[s];return t=r=l(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(o))),r.checkAuthenticate=function(){r.props.isAuthenticated||(r.props.handleLogOut(),r.props.history.push("/auth/login"))},l(r,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,o.Component),r(n,[{key:"componentDidMount",value:function(){this.checkAuthenticate()}},{key:"componentDidUpdate",value:function(){this.checkAuthenticate()}},{key:"render",value:function(){return this.props.isAuthenticated?s.default.createElement(e,this.props):null}}]),n}();return(0,i.connect)(function(e){return{isAuthenticated:e.auth.isAuthenticated}},{handleLogOut:u.handleLogOut})(t)};var a,o=n(1),s=(a=o)&&a.__esModule?a:{default:a},i=n(113),u=n(152);function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}},1293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(1294),s=(r=o)&&r.__esModule?r:{default:r},i=n(207);var u=("object"===("undefined"==typeof window?"undefined":a(window))&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):i.compose)(),l=(0,i.createStore)(s.default,u);t.default=l},1294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(207),a=u(n(1295)),o=u(n(1296)),s=u(n(1297)),i=u(n(1298));function u(e){return e&&e.__esModule?e:{default:e}}t.default=(0,r.combineReducers)({group:a.default,auth:o.default,groups:s.default,friends:i.default})},1295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{members:[]},t=arguments[1];switch(t.type){case"SET_CURRENT_GROUP":e=t.payload.group;break;case"ADD_MEMBERS_CURRENT_GROUP":e=r({},e,{members:[].concat(a(e.members),a(t.members))});break;case"DELETE_MEMBER_CURRENT_GROUP":e=r({},e,{members:[].concat(a(e.members)).filter(function(e){return e._id!==t.deleteMemberId})})}return e}},1296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a={isAuthenticated:!1,user:{}};t.default=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n.type){case"AUTH_SET_CURRENT_USER":return{isAuthenticated:(e=n.user,!!e._id),user:n.user};case"AUTH_USER_LOG_OUT":return r({},t,{isAuthenticated:!1,user:{}});default:return t}}},1297:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1];switch(t.type){case"GROUPS_INIT_GROUPS":e=t.groups;break;case"GROUPS_UPDATE_GROUP":for(var n=-1,a=0;a<e.length;a++)if(e[a]._id===t.group._id){n=a;break}if(-1!==n)if(t.changePosition)e.splice(n,1),e=[t.group].concat(r(e));else{var o=[].concat(r(e));o[n]=t.group,e=[].concat(r(o))}break;case"GROUPS_UPDATE_GROUP_BY_ID":for(var s=0;s<e.length;s++)if(e[s]._id===t.groupId){console.log(t.changePosition),e.splice(s,1),e=[t.group].concat(r(e));break}break;case"GROUPS_ADD_NEW_GROUP":0===e.length?e=[t.group]:(10===e.length&&e.splice(9,1),e=[t.group].concat(r(e)))}return e}},1298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o={all:[],filter:null};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments[1];switch(t.type){case"FRIENDS_INIT_FRIENDS_ALL":e=r({},e,{all:t.friends});break;case"FRIENDS_UPDATE_FRIEND":for(var n=-1,s=0;s<e.all.length;s++)if(e.all[s]._id===t.friend._id){n=s;break}-1!==n&&(e.all.splice(n,1),e=t.friend.online?r({},e,{all:[t.friend].concat(a(e.all))}):r({},e,{all:[].concat(a(e.all),[t.friend])}))}return e}},152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCurrentUser=function(e){var t={};e&&o.default.verify(e,"tobeornottobe",function(e,n){e||n&&(t={_id:n._id,username:n.username,avatar:n.avatar})});return{type:"AUTH_SET_CURRENT_USER",user:t}},t.handleLogOut=function(){return localStorage.removeItem("tokenJWT"),{type:"AUTH_USER_LOG_OUT"}};var r,a=n(1185),o=(r=a)&&r.__esModule?r:{default:r}},195:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCurrentGroup=function(e){return{type:"SET_CURRENT_GROUP",payload:{group:e}}},t.addMembersGroup=function(e){return{type:"ADD_MEMBERS_CURRENT_GROUP",members:e}},t.deleteMemberOfGroup=function(e){return{type:"DELETE_MEMBER_CURRENT_GROUP",deleteMemberId:e}}},540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initGroups=function(e){return{type:"GROUPS_INIT_GROUPS",groups:e}},t.handleAddNewGroup=function(e){return{type:"GROUPS_ADD_NEW_GROUP",group:e}},t.handleUpdateGroup=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{type:"GROUPS_UPDATE_GROUP",group:e,changePosition:t}},t.handleUpdateGroupById=function(e){return{type:"GROUPS_UPDATE_GROUP_BY_ID",groupId:e}}},541:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initFriends=function(e){return{type:"FRIENDS_INIT_FRIENDS_ALL",friends:e}},t.updateFriend=function(e){return{type:"FRIENDS_UPDATE_FRIEND",friend:e}}},593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setAuthorizationHeader=void 0;var r,a=n(1290),o=(r=a)&&r.__esModule?r:{default:r};t.setAuthorizationHeader=o.default},618:function(e,t,n){n(619),e.exports=n(820)},820:function(e,t,n){"use strict";var r=f(n(1)),a=f(n(8)),o=n(594),s=n(113),i=f(n(830)),u=n(593),l=n(152),c=f(n(1293));function f(e){return e&&e.__esModule?e:{default:e}}localStorage.tokenJWT?c.default.dispatch((0,l.setCurrentUser)(localStorage.tokenJWT)):c.default.dispatch((0,l.handleLogOut)()),(0,u.setAuthorizationHeader)(localStorage.tokenJWT),a.default.render(r.default.createElement(s.Provider,{store:c.default},r.default.createElement(o.BrowserRouter,null,r.default.createElement(o.Switch,null,i.default.map(function(e,t){return r.default.createElement(o.Route,{key:t,exact:e.exact,path:e.path,component:e.component})})))),document.getElementById("app"))},830:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(831)),a=o(n(1286));function o(e){return e&&e.__esModule?e:{default:e}}var s=[{path:"/",exact:!0,component:(0,o(n(1292)).default)(r.default)},{path:"/auth",component:a.default}];t.default=s},831:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),o=f(a),s=n(89);n(534);var i=f(n(1127)),u=f(n(1151)),l=f(n(1155)),c=f(n(1284));function f(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var p=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r=d(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.pushNotifycation=function(e,t){s.notification[e]({message:t})},d(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),r(t,[{key:"render",value:function(){var e=this.props.history;return o.default.createElement(a.Fragment,null,o.default.createElement(c.default,{history:e,pushNotifycation:this.pushNotifycation}),o.default.createElement("div",{className:"container-fluid"},o.default.createElement("div",{className:"row"},o.default.createElement(i.default,{pushNotifycation:this.pushNotifycation}),o.default.createElement(l.default,{history:e,pushNotifycation:this.pushNotifycation}),o.default.createElement(u.default,null))))}}]),t}();t.default=p},882:function(e,t,n){var r={"./af":355,"./af.js":355,"./ar":356,"./ar-dz":357,"./ar-dz.js":357,"./ar-kw":358,"./ar-kw.js":358,"./ar-ly":359,"./ar-ly.js":359,"./ar-ma":360,"./ar-ma.js":360,"./ar-sa":361,"./ar-sa.js":361,"./ar-tn":362,"./ar-tn.js":362,"./ar.js":356,"./az":363,"./az.js":363,"./be":364,"./be.js":364,"./bg":365,"./bg.js":365,"./bm":366,"./bm.js":366,"./bn":367,"./bn.js":367,"./bo":368,"./bo.js":368,"./br":369,"./br.js":369,"./bs":370,"./bs.js":370,"./ca":371,"./ca.js":371,"./cs":372,"./cs.js":372,"./cv":373,"./cv.js":373,"./cy":374,"./cy.js":374,"./da":375,"./da.js":375,"./de":376,"./de-at":377,"./de-at.js":377,"./de-ch":378,"./de-ch.js":378,"./de.js":376,"./dv":379,"./dv.js":379,"./el":380,"./el.js":380,"./en-au":381,"./en-au.js":381,"./en-ca":382,"./en-ca.js":382,"./en-gb":383,"./en-gb.js":383,"./en-ie":384,"./en-ie.js":384,"./en-il":385,"./en-il.js":385,"./en-nz":386,"./en-nz.js":386,"./eo":387,"./eo.js":387,"./es":388,"./es-do":389,"./es-do.js":389,"./es-us":390,"./es-us.js":390,"./es.js":388,"./et":391,"./et.js":391,"./eu":392,"./eu.js":392,"./fa":393,"./fa.js":393,"./fi":394,"./fi.js":394,"./fo":395,"./fo.js":395,"./fr":396,"./fr-ca":397,"./fr-ca.js":397,"./fr-ch":398,"./fr-ch.js":398,"./fr.js":396,"./fy":399,"./fy.js":399,"./gd":400,"./gd.js":400,"./gl":401,"./gl.js":401,"./gom-latn":402,"./gom-latn.js":402,"./gu":403,"./gu.js":403,"./he":404,"./he.js":404,"./hi":405,"./hi.js":405,"./hr":406,"./hr.js":406,"./hu":407,"./hu.js":407,"./hy-am":408,"./hy-am.js":408,"./id":409,"./id.js":409,"./is":410,"./is.js":410,"./it":411,"./it.js":411,"./ja":412,"./ja.js":412,"./jv":413,"./jv.js":413,"./ka":414,"./ka.js":414,"./kk":415,"./kk.js":415,"./km":416,"./km.js":416,"./kn":417,"./kn.js":417,"./ko":418,"./ko.js":418,"./ku":419,"./ku.js":419,"./ky":420,"./ky.js":420,"./lb":421,"./lb.js":421,"./lo":422,"./lo.js":422,"./lt":423,"./lt.js":423,"./lv":424,"./lv.js":424,"./me":425,"./me.js":425,"./mi":426,"./mi.js":426,"./mk":427,"./mk.js":427,"./ml":428,"./ml.js":428,"./mn":429,"./mn.js":429,"./mr":430,"./mr.js":430,"./ms":431,"./ms-my":432,"./ms-my.js":432,"./ms.js":431,"./mt":433,"./mt.js":433,"./my":434,"./my.js":434,"./nb":435,"./nb.js":435,"./ne":436,"./ne.js":436,"./nl":437,"./nl-be":438,"./nl-be.js":438,"./nl.js":437,"./nn":439,"./nn.js":439,"./pa-in":440,"./pa-in.js":440,"./pl":441,"./pl.js":441,"./pt":442,"./pt-br":443,"./pt-br.js":443,"./pt.js":442,"./ro":444,"./ro.js":444,"./ru":445,"./ru.js":445,"./sd":446,"./sd.js":446,"./se":447,"./se.js":447,"./si":448,"./si.js":448,"./sk":449,"./sk.js":449,"./sl":450,"./sl.js":450,"./sq":451,"./sq.js":451,"./sr":452,"./sr-cyrl":453,"./sr-cyrl.js":453,"./sr.js":452,"./ss":454,"./ss.js":454,"./sv":455,"./sv.js":455,"./sw":456,"./sw.js":456,"./ta":457,"./ta.js":457,"./te":458,"./te.js":458,"./tet":459,"./tet.js":459,"./tg":460,"./tg.js":460,"./th":461,"./th.js":461,"./tl-ph":462,"./tl-ph.js":462,"./tlh":463,"./tlh.js":463,"./tr":464,"./tr.js":464,"./tzl":465,"./tzl.js":465,"./tzm":466,"./tzm-latn":467,"./tzm-latn.js":467,"./tzm.js":466,"./ug-cn":468,"./ug-cn.js":468,"./uk":469,"./uk.js":469,"./ur":470,"./ur.js":470,"./uz":471,"./uz-latn":472,"./uz-latn.js":472,"./uz.js":471,"./vi":473,"./vi.js":473,"./x-pseudo":474,"./x-pseudo.js":474,"./yo":475,"./yo.js":475,"./zh-cn":476,"./zh-cn.js":476,"./zh-hk":477,"./zh-hk.js":477,"./zh-tw":478,"./zh-tw.js":478};function a(e){var t=o(e);return n(t)}function o(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id=882}},[[618,1,2]]]);